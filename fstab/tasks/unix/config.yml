---

#-------------------------------------------------------------------------------
# FILES
#-------------------------------------------------------------------------------

- name: 'line config fstab'
  lineinfile:
    state: "{{'absent' if (item.state is defined) and (item.state|match('false|no|remove')) else 'present'}}"
    line: "{{(item.filesystem|e)}}  {{(item.mountpoint|e)}}  {{(item.type|e)}}  {{(item.options|join(',')) if (item.options is defined) and not (item.options == '') else 'defaults'}}  {{(item.dump|int(0)) if (item.dump is defined) and not (item.dump == '') else 0}} {{(item.pass|int(0)) if (item.pass is defined) and not (item.pass == '') else 0}} # {{(item.comment|e) if (item.comment is defined) else ''}} | Ansible: {{item.mountpoint|md5}}"
    regexp: '{{item.mountpoint|md5}}$'
    dest: "{{(item.path|e) if (item.path is defined) and not (item.path == '') else fstab_path_default}}"
  with_items: "{{fstab_all + fstab_group + fstab_host}}"
  tags:
    - files
    - config
    - unix
    - fstab
