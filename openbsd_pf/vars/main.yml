---
#-------------------------------------------------------------------------------
#
# Name   : main.yml
# Type   : ansible variable file
# Role   : openbsd_pf
#
# Authors: liv community
# License: Simplified BSD License
#
#-------------------------------------------------------------------------------

#-------------------------------------------------------------------------------
# FILES
#-------------------------------------------------------------------------------

# pf.conf
file_src_pf_conf: "templates/{{(openbsd_pf_pf_conf_template|e)}}/pf.conf.j2"
file_path_pf_conf: '/etc/pf.conf'
file_mode_pf_conf: '0600'
file_owner_pf_conf: 'root'
file_group_pf_conf: 'wheel'

# pf.blacklist
file_src_pf_blacklist: "templates/{{(openbsd_pf_pf_blacklist_template|e)}}/pf.blacklist.j2"
file_path_pf_blacklist: '/etc/pf.blacklist'
file_mode_pf_blacklist: '0600'
file_owner_pf_blacklist: 'root'
file_group_pf_blacklist: 'wheel'

#-------------------------------------------------------------------------------
# COMMANDS
#-------------------------------------------------------------------------------

# check openbsd_pf
raw_cmd_check_openbsd_pf: 'pfctl -s info | grep -iq "^status: enabled.*"'

# disable openbsd_pf
command_cmd_disable_openbsd_pf: 'rcctl disable pf'

# enable openbsd_pf
command_cmd_enable_openbsd_pf: 'rcctl enable pf'

# reload openbsd_pf
command_cmd_reload_openbsd_pf: "pfctl -f {{file_path_pf_conf}}"

# start openbsd_pf
command_cmd_start_openbsd_pf: 'pfctl -e'

# status openbsd_pf
command_cmd_status_openbsd_pf: 'rcctl get pf status'

# stop openbsd_pf
command_cmd_stop_openbsd_pf: 'pfctl -d'

# validate openbsd_pf
command_cmd_validate_openbsd_pf: "pfctl -nf {{file_path_pf_conf}}"
