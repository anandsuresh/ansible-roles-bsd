#-------------------------------------------------------------------------------
#                             ANSIBLE MANAGED FILE
#-------------------------------------------------------------------------------

#-------------------------------------------------------------------------------
# INFORMATION
#-------------------------------------------------------------------------------
#
# Name   : hosts.allow
# Type   : hosts configuration file
# Role   : denyhosts
#
# Authors: liv community
# License: Simplified BSD License
#
#-------------------------------------------------------------------------------

#
# hosts.allow access control file for "tcp wrapped" applications.
# $FreeBSD: releng/12.1/lib/libwrap/hosts.allow 338887 2018-09-22 13:17:30Z brd $
#
# NOTE: The hosts.deny file is deprecated.
#       Place both 'allow' and 'deny' rules in the hosts.allow file.
#       See hosts_options(5) for the format of this file.
#       hosts_access(5) no longer fully applies.
#

{% if (denyhosts_block_service is match('all|any')) %}
ALL : /etc/hosts.block : deny
ALL : ALL : allow
{% else %}
sshd : /etc/hosts.block : deny
sshd : ALL : allow
{% endif %}
